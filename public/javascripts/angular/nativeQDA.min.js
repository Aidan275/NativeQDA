(function(){angular.module("nativeQDAApp",["ngRoute","ngSanitize","ngTable","ui.bootstrap","ui.bootstrap.datepicker","rzModule"]);e.$inject=["$routeProvider","$locationProvider"];function e(e,a){e.when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/forgot-password",{templateUrl:"/auth/forgotPass/forgotPass.view.html",controller:"forgotPassCtrl",controllerAs:"vm"}).when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/analysis/map",{templateUrl:"/analysis/map/map.view.html",controller:"mapCtrl",controllerAs:"vm"}).when("/analysis/data",{templateUrl:"/analysis/data/data.view.html",controller:"dataCtrl",controllerAs:"vm"}).when("/analysis/visualisation",{templateUrl:"/analysis/visualisation/visualisation.view.html",controller:"visualisationCtrl",controllerAs:"vm"}).when("/survey",{templateUrl:"/survey/survey.view.html",controller:"surveyCtrl",controllerAs:"vm"}).when("/files",{templateUrl:"/files/files.view.html",controller:"filesCtrl",controllerAs:"vm"}).when("/settings",{templateUrl:"/settings/settings.view.html",controller:"settingsCtrl",controllerAs:"vm"}).when("/complete-survey",{templateUrl:"/survey/completeSurvey/completeSurvey.view.html",controller:"CompleteSurveyCtrl",controllerAs:"vm"}).when("/heatmap-example",{templateUrl:"/heatmapExample/heatmapExample.view.html",controller:"heatmapCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});a.html5Mode(true)}function a(e,a,t){e.$on("$routeChangeStart",function(e,n,o){if(n.$$route.templateUrl=="/survey/completeSurvey/completeSurvey.view.html"){a.path("/complete-survey")}else if(n.$$route.templateUrl=="/auth/forgotPass/forgotPass.view.html"){a.path("/forgot-password")}else if(!t.isLoggedIn()){a.path("/login")}})}angular.module("nativeQDAApp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",a])})();(function(){angular.module("nativeQDAApp").controller("homeCtrl",e);e.$inject=["$scope","geolocation","GoogleMapsInitialiser","authentication","events"];function e(e,a,t,n,o){var i=this;i.pageHeader={title:"Dashboard",strapline:"summary of recent activity"};var r=-34.406749;var l=150.878473;i.getData=function(e){r=e.coords.latitude;l=e.coords.longitude;s(r,l);var a={email:n.currentUser().email,lat:r,lng:l};o.event(a)};i.showError=function(a){e.$apply(function(){i.message=a.message;console.log(i.message);s(r,l)})};i.noGeo=function(){e.$apply(function(){i.message="Geolocation is not supported by this browser.";console.log(i.message);s(r,l)})};a.getPosition(i.getData,i.showError,i.noGeo);function s(e,a){t.mapsInitialised.then(function(){var t=new google.maps.LatLng(e,a);var n=document.getElementById("map-homepage");var o={center:t,zoom:4,panControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT,position:google.maps.ControlPosition.TOP_RIGHT}};var i=new google.maps.Map(n,o);var r={australia:{icon:"/images/map/icons/kangaroo-markers/kangaroo-marker.png"},newZealand:{icon:"/images/map/icons/kiwi-markers/kiwi-marker.png"},newCaledonia:{icon:"/images/map/icons/kagu-markers/kagu-marker.png"}};var l=[{position:new google.maps.LatLng(-34.195122,145.61361),type:"australia"},{position:new google.maps.LatLng(-27.782105,144.988068),type:"australia"},{position:new google.maps.LatLng(-31.617175,149.755251),type:"australia"},{position:new google.maps.LatLng(-34.183426,145.531326),type:"australia"},{position:new google.maps.LatLng(-23.004057,150.208288),type:"australia"},{position:new google.maps.LatLng(-23.36721,148.562199),type:"australia"},{position:new google.maps.LatLng(-27.149085,148.392517),type:"australia"},{position:new google.maps.LatLng(-27.171054,148.692928),type:"australia"},{position:new google.maps.LatLng(-21.676721,166.040641),type:"newCaledonia"},{position:new google.maps.LatLng(-21.198481,165.322936),type:"newCaledonia"},{position:new google.maps.LatLng(-20.650302,164.73978),type:"newCaledonia"},{position:new google.maps.LatLng(-20.51384,164.399452),type:"newCaledonia"},{position:new google.maps.LatLng(-20.765698,164.41047),type:"newCaledonia"},{position:new google.maps.LatLng(-20.625109,164.786398),type:"newCaledonia"},{position:new google.maps.LatLng(-22.259586,166.453261),type:"newCaledonia"},{position:new google.maps.LatLng(-40.768675,175.207908),type:"newZealand"},{position:new google.maps.LatLng(-41.114069,174.107308),type:"newZealand"},{position:new google.maps.LatLng(-41.101032,175.183516),type:"newZealand"},{position:new google.maps.LatLng(-40.145982,176.593862),type:"newZealand"},{position:new google.maps.LatLng(-39.454753,173.929295),type:"newZealand"},{position:new google.maps.LatLng(-39.060873,176.168224),type:"newZealand"},{position:new google.maps.LatLng(-43.974486,169.417745),type:"newZealand"},{position:new google.maps.LatLng(-45.77995,170.528945),type:"newZealand"}];var s=[];var g=[];var p=[];var c='<div class="info-window">'+"<h3>Data</h3>"+'<div class="info-content">'+"<p>Data collected from interview</p>"+'<a href="/files">Interview.doc</a>'+"</div>"+"</div>";var u=new google.maps.InfoWindow({content:c,maxWidth:400});l.forEach(function(e){var a=new google.maps.Marker({position:e.position,icon:r[e.type].icon});a.addListener("click",function(){u.open(i,a)});if(a.icon=="/images/map/icons/kangaroo-markers/kangaroo-marker.png"){s.push(a)}else if(a.icon=="/images/map/icons/kiwi-markers/kiwi-marker.png"){g.push(a)}else if(a.icon=="/images/map/icons/kagu-markers/kagu-marker.png"){p.push(a)}});var m=new MarkerClusterer(i,s,{imagePath:"/images/map/icons/kangaroo-markers/m"});var d=new MarkerClusterer(i,g,{imagePath:"/images/map/icons/kiwi-markers/m"});var w=new MarkerClusterer(i,p,{imagePath:"/images/map/icons/kagu-markers/m"})})}}})();(function(){angular.module("nativeQDAApp").controller("loginCtrl",e);e.$inject=["$location","geolocation","authentication","events"];function e(e,a,t,n){var o=this;o.credentials={email:"",password:""};o.pageHeader={title:"Sign in to nativeQDA"};o.returnPage=e.search().page||"/";o.onSubmit=function(){o.formError="";if(!o.credentials.email||!o.credentials.password){o.formError="All fields required, please try again";return false}else{o.doLogin()}};o.doLogin=function(){o.formError="";n.event({email:o.credentials.email,desc:"Login"});t.login(o.credentials).then(function(a){e.search("page",null);e.path(o.returnPage)},function(e){o.formError=e.data.message})}}})();(function(){angular.module("nativeQDAApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,a){var t=this;t.pageHeader={title:"Create a new nativeQDA account"};t.credentials={name:"",email:"",password:""};t.returnPage=e.search().page||"/";t.onSubmit=function(){t.formError="";if(!t.credentials.name||!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again";return false}else{t.doRegister()}};t.doRegister=function(){t.formError="";a.register(t.credentials).then(function(){e.search("page",null);e.path(t.returnPage)},function(e){t.formError=e})}}})();(function(){angular.module("nativeQDAApp").controller("forgotPassCtrl",e);e.$inject=["authentication"];function e(e){var a=this;a.pageHeader={title:"Forgot Password"};a.credentials={email:""};a.onSubmit=function(){a.formError="";if(!a.credentials.email){a.formError="All fields required, please try again";return false}else{console.log("Send email to "+a.credentials.email+" to reset password!")}}}})();(function(){angular.module("nativeQDAApp").controller("locationDetailCtrl",e);e.$inject=["$routeParams","$location","$uibModal","nativeQDAData","authentication"];function e(e,a,t,n,o){var i=this;i.locationid=e.locationid;i.isLoggedIn=o.isLoggedIn();i.currentPath=a.path();n.locationById(i.locationid).then(function(e){var a=e.data;i.data={location:a};i.pageHeader={title:i.data.location.name}},function(e){console.log(e)});i.popupReviewForm=function(){var e=t.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalCtrl as vm",resolve:{locationData:function(){return{locationid:i.locationid,locationName:i.data.location.name}}}});e.result.then(function(e){i.data.location.reviews.push(e)})}}})();(function(){angular.module("nativeQDAApp").controller("mapCtrl",e);e.$inject=["$scope","geolocation","GoogleMapsInitialiser","authentication","events"];function e(e,a,t,n,o){var i=this;var r=-34.406749;var l=150.878473;var s=5;i.getData=function(e){r=e.coords.latitude;l=e.coords.longitude;userDetails={email:n.currentUser().email,lat:r,lng:l};o.event(userDetails);s=20;g(r,l)};i.showError=function(a){e.$apply(function(){i.message=a.message;console.log(i.message);g(r,l)})};i.noGeo=function(){e.$apply(function(){i.message="Geolocation is not supported by this browser.";console.log(i.message);g(r,l)})};a.getPosition(i.getData,i.showError,i.noGeo);function g(e,a){t.mapsInitialised.then(function(){var t=new google.maps.LatLng(e,a);var n=document.getElementById("map");var o={center:t,zoom:s,panControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT,position:google.maps.ControlPosition.TOP_RIGHT}};var i=new google.maps.Map(n,o);var r={australia:{icon:"/images/map/icons/kangaroo-markers/kangaroo-marker.png"},newZealand:{icon:"/images/map/icons/kiwi-markers/kiwi-marker.png"},newCaledonia:{icon:"/images/map/icons/kagu-markers/kagu-marker.png"}};var l=[{position:new google.maps.LatLng(-34.195122,145.61361),type:"australia"},{position:new google.maps.LatLng(-27.782105,144.988068),type:"australia"},{position:new google.maps.LatLng(-31.617175,149.755251),type:"australia"},{position:new google.maps.LatLng(-34.183426,145.531326),type:"australia"},{position:new google.maps.LatLng(-23.004057,150.208288),type:"australia"},{position:new google.maps.LatLng(-23.36721,148.562199),type:"australia"},{position:new google.maps.LatLng(-27.149085,148.392517),type:"australia"},{position:new google.maps.LatLng(-27.171054,148.692928),type:"australia"},{position:new google.maps.LatLng(-21.676721,166.040641),type:"newCaledonia"},{position:new google.maps.LatLng(-21.198481,165.322936),type:"newCaledonia"},{position:new google.maps.LatLng(-20.650302,164.73978),type:"newCaledonia"},{position:new google.maps.LatLng(-20.51384,164.399452),type:"newCaledonia"},{position:new google.maps.LatLng(-20.765698,164.41047),type:"newCaledonia"},{position:new google.maps.LatLng(-20.625109,164.786398),type:"newCaledonia"},{position:new google.maps.LatLng(-22.259586,166.453261),type:"newCaledonia"},{position:new google.maps.LatLng(-40.768675,175.207908),type:"newZealand"},{position:new google.maps.LatLng(-41.114069,174.107308),type:"newZealand"},{position:new google.maps.LatLng(-41.101032,175.183516),type:"newZealand"},{position:new google.maps.LatLng(-40.145982,176.593862),type:"newZealand"},{position:new google.maps.LatLng(-39.454753,173.929295),type:"newZealand"},{position:new google.maps.LatLng(-39.060873,176.168224),type:"newZealand"},{position:new google.maps.LatLng(-43.974486,169.417745),type:"newZealand"},{position:new google.maps.LatLng(-45.77995,170.528945),type:"newZealand"}];var g=[];var p=[];var c=[];var u='<div class="info-window">'+"<h3>Data</h3>"+'<div class="info-content">'+"<p>Data collected from interview</p>"+'<a href="/files">Interview.doc</a>'+"</div>"+"</div>";var m=new google.maps.InfoWindow({content:u,maxWidth:400});l.forEach(function(e){var a=new google.maps.Marker({position:e.position,icon:r[e.type].icon});a.addListener("click",function(){m.open(i,a)});if(a.icon=="/images/map/icons/kangaroo-markers/kangaroo-marker.png"){g.push(a)}else if(a.icon=="/images/map/icons/kiwi-markers/kiwi-marker.png"){p.push(a)}else if(a.icon=="/images/map/icons/kagu-markers/kagu-marker.png"){c.push(a)}});var d=new MarkerClusterer(i,g,{imagePath:"/images/map/icons/kangaroo-markers/m"});var w=new MarkerClusterer(i,p,{imagePath:"/images/map/icons/kiwi-markers/m"});var v=new MarkerClusterer(i,c,{imagePath:"/images/map/icons/kagu-markers/m"})})}}})();(function(){angular.module("nativeQDAApp").controller("dataCtrl",e);e.$inject=["$scope","$window","$sce","$uibModal","NgTableParams","datasets"];function e(e,a,t,n,o,i){var r=this;var l;r.pageHeader={title:"Data",strapline:"where the Datasets live"};e.open1=function(){e.popup1.opened=true};e.format="dd MMMM, yyyy";e.altInputFormats=["d!/M!/yyyy"];e.popup1={opened:false};r.popupViewDatasetForm=function(e){var a=n.open({templateUrl:"/analysis/data/viewDataset/viewDataset.view.html",controller:"viewDatasetCtrl as vm",size:"lg",resolve:{datasetid:function(){return e}}});a.result.then(function(){})};r.popupEditDatasetForm=function(e,a){var t=n.open({templateUrl:"/analysis/data/editDataset/editDataset.view.html",controller:"editDatasetCtrl as vm",size:"xl"});t.result.then(function(){r.getDatasetList()})};r.popupNewDatasetForm=function(){var e=n.open({templateUrl:"/analysis/data/newDataset/newDataset.view.html",controller:"newDatasetCtrl as vm",size:"xl"});e.result.then(function(){r.getDatasetList()})};r.doListDatasets=function(e){l=e;r.tableParams=new o({sorting:{dateCreated:"asc"}},{dataset:l})};r.getDatasetList=function(){i.listDatasets().then(function(e){r.doListDatasets(e.data)},function(e){console.log(e)});return false};r.getDatasetList();r.doDeleteDataset=function(e){i.datasetDeleteOne(e).then(function(e){r.getDatasetList()},function(e){console.log(e)});return false};e.confirmDelete=function(e,t){deleteDataset=a.confirm("Are you sure you want to delete "+e+"?");if(deleteDataset){r.doDeleteDataset(t)}}}})();(function(){angular.module("nativeQDAApp").controller("newDatasetCtrl",e);e.$inject=["$uibModalInstance","datasets"];function e(e,a){var t=this;t.onSubmit=function(){t.formError="";if(angular.isDefined(t.formData)){if(!t.formData.datasetName||!t.formData.description){t.formError="All fields required, please try again";return false}else{t.doCreateDataset(t.formData)}}else{t.formError="All fields required, please try again";return false}};t.doCreateDataset=function(e){a.datasetCreate({name:t.formData.datasetName,desc:t.formData.description}).then(function(e){t.modal.close(e.data)},function(e){t.formError="The Dataset was not saved, please try again"});return false};t.modal={close:function(){e.close()},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("nativeQDAApp").controller("viewDatasetCtrl",e);e.$inject=["$uibModalInstance","datasets","datasetid"];function e(e,a,t){var n=this;n.datasetid=t;a.datasetReadOne(n.datasetid).then(function(e){n.data=e.data},function(e){console.log(e)});n.modal={close:function(){e.close()},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("nativeQDAApp").controller("editDatasetCtrl",e);e.$inject=["$uibModalInstance","datasets"];function e(e,a){var t=this;t.modal={close:function(){e.close()},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("nativeQDAApp").controller("visualisationCtrl",e);e.$inject=["$scope","$window","NgTableParams","$sce","$uibModal"];function e(e,a,t,n,o){var i=this;i.pageHeader={title:"Visualisation",strapline:"visualise data sets here"};i.popupVisualisationForm=function(){var e=o.open({templateUrl:"/analysis/visualisation/newVisualisation/newVisualisation.view.html",controller:"newVisualisationCtrl as vm",size:"xl"});e.result.then(function(){})};var r=[{visual:"Concept Map",visualThumb:"concept-map-thumb.png",dataSet:"English vs French",createdBy:"Anu",dateCreated:"2017/04/25",command:"id1"},{visual:"Word Cloud",visualThumb:"word-cloud-thumb.png",dataSet:"English vs French",createdBy:"Anu",dateCreated:"2016/01/12",command:"id2"},{visual:"Chord Diagram",visualThumb:"chord-diagram-thumb.png",dataSet:"English vs French",createdBy:"Anu",dateCreated:"2016/03/29",command:"id3"},{visual:"Concept Map",visualThumb:"concept-map-thumb.png",dataSet:"Kanaks - Drehu",createdBy:"Michael",dateCreated:"2016/09/15",command:"id4"},{visual:"Concept Map",visualThumb:"concept-map-thumb.png",dataSet:"English vs French",createdBy:"Anu",dateCreated:"2017/04/25",command:"id5"},{visual:"Word Frequency Chart",visualThumb:"bar-chart-thumb.png",dataSet:"Kanaks - Drehu",createdBy:"Michael",dateCreated:"2016/01/12",command:"id6"},{visual:"Word Tree",visualThumb:"word-tree-thumb.png",dataSet:"Qualitative study of the Moriori language",createdBy:"Michael",dateCreated:"2017/03/29",command:"id7"}];i.tableParams=new t({},{dataset:r});e.confirmDelete=function(){a.confirm("Are you sure?")}}})();(function(){angular.module("nativeQDAApp").controller("newVisualisationCtrl",e);e.$inject=["$uibModalInstance"];function e(e){var a=this;a.onSubmit=function(){a.formError="";if(angular.isDefined(a.formData)){if(!a.formData.visualisationName){a.formError="All fields required, please try again";return false}else{console.log("Create Visualisation!")}}else{a.formError="All fields required, please try again";return false}};a.modal={close:function(a){e.close(a)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("nativeQDAApp").controller("CompleteSurveyCtrl",e);function e(){var e=this;e.surveyCode="";e.onSubmit=function(){e.formError="";if(!e.surveyCode){e.formError="All fields required, please try again";return false}else{console.log("Find survey and display to user!")}}}})();(function(){angular.module("nativeQDAApp").controller("surveyCtrl",e);e.$inject=["$scope","$window","NgTableParams","$sce","$uibModal"];function e(e,a,t,n,o){var i=this;i.pageHeader={title:"Surveys",strapline:"for the masses"};i.popupNewSurveyForm=function(){var e=o.open({templateUrl:"/survey/newSurvey/newSurvey.view.html",controller:"newSurveyCtrl as vm",size:"xl"});e.result.then(function(){})};var r=[{survey:"Survey",createdBy:"Anu",responses:12,dateCreated:"2017/05/26",command:"id1"},{survey:"Survey2",createdBy:"Michael",responses:50,dateCreated:"2017/05/02",command:"id1"},{survey:"Survey3",createdBy:"Michael",responses:23,dateCreated:"2017/02/12",command:"id1"},{survey:"Survey4",createdBy:"Anu",responses:50,dateCreated:"2017/02/15",command:"id1"},{survey:"Survey5",createdBy:"Holly",responses:11,dateCreated:"2017/04/02",command:"id1"},{survey:"Survey6",createdBy:"Anu",responses:1,dateCreated:"2017/01/11",command:"id1"},{survey:"Survey7",createdBy:"Michael",responses:100,dateCreated:"2017/01/23",command:"id1"}];i.tableParams=new t({},{dataset:r});e.confirmDelete=function(){a.confirm("Are ya sure?")}}})();(function(){angular.module("nativeQDAApp").controller("newSurveyCtrl",e);e.$inject=["$uibModalInstance"];function e(e){var a=this;a.onSubmit=function(){a.formError="";if(angular.isDefined(a.formData)){if(!a.formData.surveyName){a.formError="All fields required, please try again";return false}else{console.log("Create Survey!")}}else{a.formError="All fields required, please try again";return false}};a.modal={close:function(a){e.close(a)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("nativeQDAApp").controller("heatmapCtrl",e);e.$inject=["$scope","geolocation","GoogleMapsInitialiser","authentication","events"];function e(e,a,t,n,o){var i=this;var r=-33.848192;var l=151.061857;var s=10;o.event({email:n.currentUser().email});i.bothOver=true;i.fatherOver=true;i.MotherOver=true;i.bothAus=true;g(r,l);function g(e,a){t.mapsInitialised.then(function(){var t=new google.maps.LatLng(e,a);var n=document.getElementById("map");var o={center:t,zoom:s,panControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT,position:google.maps.ControlPosition.TOP_RIGHT}};var r=[{location:new google.maps.LatLng(-33.8584827,151.12866859999997),weight:9029},{location:new google.maps.LatLng(-36.0737293,146.91354179999996),weight:358},{location:new google.maps.LatLng(-33.81527799999999,151.10111099999995),weight:3235},{location:new google.maps.LatLng(-33.76288,150.99212),weight:7427},{location:new google.maps.LatLng(-33.771,150.9063),weight:21538},{location:new google.maps.LatLng(-33.8688197,151.20929550000005),weight:4163},{location:new google.maps.LatLng(-33.83965,151.20541000000003),weight:8865},{location:new google.maps.LatLng(-33.68919759999999,151.26853819999997),weight:1618},{location:new google.maps.LatLng(-33.91735159999999,150.9283736),weight:5627},{location:new google.maps.LatLng(-33.49999729999999,150.2499997),weight:3383},{location:new google.maps.LatLng(-33.81499999999999,151.00111100000004),weight:27386},{location:new google.maps.LatLng(-33.90006659999999,150.84785220000003),weight:11435},{location:new google.maps.LatLng(-34.03314,151.05830000000003),weight:1552},{location:new google.maps.LatLng(-33.3529519,151.44354739999994),weight:979},{location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:121088}];var l=[{location:new google.maps.LatLng(-33.8584827,151.12866859999997),weight:187},{location:new google.maps.LatLng(-36.0737293,146.91354179999996),weight:18},{location:new google.maps.LatLng(-33.81527799999999,151.10111099999995),weight:64},{location:new google.maps.LatLng(-33.76288,150.99212),weight:141},{location:new google.maps.LatLng(-33.771,150.9063),weight:224},{location:new google.maps.LatLng(-33.8688197,151.20929550000005),weight:130},{location:new google.maps.LatLng(-33.83965,151.20541000000003),weight:202},{location:new google.maps.LatLng(-33.68919759999999,151.26853819999997),weight:96},{location:new google.maps.LatLng(-33.91735159999999,150.9283736),weight:132},{location:new google.maps.LatLng(-33.49999729999999,150.2499997),weight:165},{location:new google.maps.LatLng(-33.81499999999999,151.00111100000004),weight:179},{location:new google.maps.LatLng(-33.90006659999999,150.84785220000003),weight:123},{location:new google.maps.LatLng(-34.03314,151.05830000000003),weight:107},{location:new google.maps.LatLng(-33.3529519,151.44354739999994),weight:128},{location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:2219}];var g=[{location:new google.maps.LatLng(-33.8584827,151.12866859999997),weight:129},{location:new google.maps.LatLng(-36.0737293,146.91354179999996),weight:15},{location:new google.maps.LatLng(-33.81527799999999,151.10111099999995),weight:53},{location:new google.maps.LatLng(-33.76288,150.99212),weight:127},{location:new google.maps.LatLng(-33.771,150.9063),weight:151},{location:new google.maps.LatLng(-33.8688197,151.20929550000005),weight:106},{location:new google.maps.LatLng(-33.83965,151.20541000000003),weight:173},{location:new google.maps.LatLng(-33.68919759999999,151.26853819999997),weight:60},{location:new google.maps.LatLng(-33.91735159999999,150.9283736),weight:83},{location:new google.maps.LatLng(-33.49999729999999,150.2499997),weight:98},{location:new google.maps.LatLng(-33.81499999999999,151.00111100000004),weight:145},{location:new google.maps.LatLng(-33.90006659999999,150.84785220000003),weight:98},{location:new google.maps.LatLng(-34.03314,151.05830000000003),weight:59},{location:new google.maps.LatLng(-33.3529519,151.44354739999994),weight:95},{location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:1681}];var p=[{location:new google.maps.LatLng(-33.8584827,151.12866859999997),weight:68},{location:new google.maps.LatLng(-36.0737293,146.91354179999996),weight:13},{location:new google.maps.LatLng(-33.81527799999999,151.10111099999995),weight:45},{location:new google.maps.LatLng(-33.76288,150.99212),weight:66},{location:new google.maps.LatLng(-33.771,150.9063),weight:99},{location:new google.maps.LatLng(-33.8688197,151.20929550000005),weight:62},{location:new google.maps.LatLng(-33.83965,151.20541000000003),weight:116},{location:new google.maps.LatLng(-33.68919759999999,151.26853819999997),weight:65},{location:new google.maps.LatLng(-33.91735159999999,150.9283736),weight:69},{location:new google.maps.LatLng(-33.49999729999999,150.2499997),weight:96},{location:new google.maps.LatLng(-33.81499999999999,151.00111100000004),weight:84},{location:new google.maps.LatLng(-33.90006659999999,150.84785220000003),weight:43},{location:new google.maps.LatLng(-34.03314,151.05830000000003),weight:47},{location:new google.maps.LatLng(-33.3529519,151.44354739999994),weight:106},{location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:1110}];var c=new google.maps.Map(n,o);var u=new google.maps.visualization.HeatmapLayer;var m=null;i.radiusSlider={value:100,options:{floor:0,ceil:200,onChange:function(){u.set("radius",i.radiusSlider.value)}}};i.opacitySlider={value:.6,options:{floor:0,ceil:1,step:.01,precision:10,onChange:function(){u.set("opacity",i.opacitySlider.value)}}};i.updateMap=function(){if(u){u.setMap(null)}var e=[];if(i.bothOver){Array.prototype.push.apply(e,r)}if(i.fatherOver){Array.prototype.push.apply(e,l)}if(i.MotherOver){Array.prototype.push.apply(e,g)}if(i.bothAus){Array.prototype.push.apply(e,p)}u.setData(e);u.set("radius",i.radiusSlider.value);u.set("opacity",i.opacitySlider.value);u.set("gradient",m);u.setMap(c)};i.removeGrtSyd=function(){if(i.rmGrtSyd){r.pop();l.pop();g.pop();p.pop()}else{r.push({location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:121088});l.push({location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:2219});g.push({location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:1681});p.push({location:new google.maps.LatLng(-33.88175470000001,150.8609358),weight:1110})}i.updateMap()};i.changeGradient=function(){if(i.changeGrad){m=["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"]}else{m=null}i.updateMap()};i.updateMap()})}}})();(function(){angular.module("nativeQDAApp").controller("filesCtrl",e);function e(){var e=this;e.pageHeader={title:"Files",strapline:"explore folders for files"}}})();(function(){angular.module("nativeQDAApp").controller("settingsCtrl",e);function e(){var e=this;e.pageHeader={title:"Settings",strapline:"change how things work"}}})();(function(){angular.module("nativeQDAApp").service("datasets",e);e.$inject=["$http","authentication"];function e(e,a){var t=function(t){return e.post("/api/analysis/data/create",t,{headers:{Authorization:"Bearer "+a.getToken()}})};var n=function(t){return e.get("/api/analysis/data",t,{headers:{Authorization:"Bearer "+a.getToken()}})};var o=function(t){return e.get("/api/analysis/data/"+t,{headers:{Authorization:"Bearer "+a.getToken()}})};var i=function(t){return e.delete("/api/analysis/data/delete/"+t,{headers:{Authorization:"Bearer "+a.getToken()}})};return{datasetCreate:t,listDatasets:n,datasetReadOne:o,datasetDeleteOne:i}}})();(function(){angular.module("nativeQDAApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,a){var t=function(e){a.localStorage["nativeQDA-token"]=e};var n=function(){return a.localStorage["nativeQDA-token"]};var o=function(){var e=n();if(e){var t=JSON.parse(a.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var e=n();var t=JSON.parse(a.atob(e.split(".")[1]));return{email:t.email,name:t.name}}};register=function(a){return e.post("/api/register",a).then(function(e){t(e.data.token)})};login=function(a){return e.post("/api/login",a).then(function(e){t(e.data.token)})};logout=function(t){a.localStorage.removeItem("nativeQDA-token");return e.post("/api/event",t)};return{currentUser:i,saveToken:t,getToken:n,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("nativeQDAApp").service("events",e);e.$inject=["$http"];function e(e){event=function(a){return e.post("/api/event",a)};return{event:event}}})();(function(){angular.module("nativeQDAApp").service("geolocation",e);function e(){var e=function(e,a,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,a)}else{t()}};return{getPosition:e}}})();(function(){angular.module("nativeQDAApp").service("GoogleMapsInitialiser",e);e.$inject=["$window","$q"];function e(e,a){var t="https://maps.googleapis.com/maps/api/js?key=AIzaSyCEMpLtx0n2Pk4ggQonEyD0iPZbGHYhR5o&libraries=visualization&callback=",n=a.defer();e.googleMapsInitialised=n.resolve;var o=function(e,a){var t=document.createElement("script");t.src=e+a;document.body.appendChild(t)};o(t,"googleMapsInitialised");return{mapsInitialised:n.promise}}})();(function(){angular.module("nativeQDAApp").filter("formatDistance",a);var e=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};function a(){return function(a){var t=a/1e3;var n;if(a&&e(a)){if(t>1){t=parseFloat(t).toFixed(1);n=" km"}else{t=parseInt(t*1e3,10);n=" m"}return t+n}else{return"?"}}}})();(function(){angular.module("nativeQDAApp").filter("addHtmlLineBreaks",e);function e(){return function(e){var a=e.replace(/\n/g,"<br/>");return a}}})();(function(){angular.module("nativeQDAApp").directive("initBind",e);e.$inject=["$compile"];function e(e){return{restrict:"A",link:function(a,t,n){n.$observe("ngBindHtml",function(){if(n.ngBindHtml){e(t[0].children)(a)}})}}}})();(function(){angular.module("nativeQDAApp").controller("navigationCtrl",e);e.$inject=["$location","authentication","events"];function e(e,a,t){var n=this;t.event({email:a.currentUser().email});n.currentPath=e.path();n.isLoggedIn=a.isLoggedIn();n.currentUser=a.currentUser();n.logout=function(){a.logout({email:a.currentUser().email,desc:"Logout"});e.path("/$logged-out")}}})();(function(){angular.module("nativeQDAApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("nativeQDAApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("nativeQDAApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("nativeQDAApp").directive("ratingStars",e);function e(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}}})();